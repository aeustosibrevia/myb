## Ключові сценарії роботи застусунку

### Створення задачі
- У таблицю **Task** додається новий запис.
- За потреби створюється запис у **UserMessage** з порадою ШІ.
- Опціонально фіксується лог запиту до AI-моделі (промпт + відповідь).

---

### Виконання задачі
- У **Task** оновлюється `status = completed`, записується `completed_at`.
- У **User** збільшується `xp` та оновлюється `streak_days`.
- Може змінитися `current_rank_id`, якщо користувач переходить на новий ранг.
- Створюється запис у **UserMessage** з мотивуючим повідомленням або повідомленням про досягнення.

---

### Провал задачі
- У **Task** оновлюється `status = failed`.
- У таблицю **Payment** додається запис про списання коштів (штраф) та донат.
- У **User** обнуляється `streak_days`.
- У **UserMessage** створюється запис типу `motivation` або `encouragement`.

---

### Отримання AI-поради
- Створюється запис у **UserMessage** з типом `advice`.
- Опціонально у внутрішній журнал зберігається промпт і відповідь ШІ (необов’язково).

---

### Оновлення рангу
- Система перевіряє `xp` користувача.
- Якщо досягнуто нового порогу — оновлюється `User.current_rank_id`.
- Створюється відповідний запис у **UserMessage** про підвищення рангу.

---

### Перегляд статистики
- Система агрегує:
  - завершені та провалені задачі з **Task**
  - загальний XP
  - поточний стрік
  - дані про платежі з **Payment**
  - поточний ранг
- Дані не змінюються — лише читаються і обчислюються для інтерфейсу користувача.
